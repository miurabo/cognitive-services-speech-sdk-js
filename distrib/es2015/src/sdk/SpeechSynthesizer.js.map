{"version":3,"sources":["src/sdk/SpeechSynthesizer.ts"],"names":[],"mappings":"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","file":"SpeechSynthesizer.js","sourcesContent":["/* eslint-disable @typescript-eslint/no-empty-function */\n// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT license.\n\n/* eslint-disable max-classes-per-file */\n\nimport { PathLike } from \"fs\";\nimport { IRestResponse } from \"../common.browser/RestMessageAdapter\";\nimport {\n    AutoDetectSourceLanguagesOpenRangeOptionName,\n    CognitiveSubscriptionKeyAuthentication,\n    CognitiveTokenAuthentication,\n    Context,\n    IAuthentication,\n    ISynthesisConnectionFactory,\n    OS,\n    SpeechServiceConfig,\n    SpeechSynthesisConnectionFactory,\n    SynthesisAdapterBase,\n    SynthesisRestAdapter,\n    SynthesizerConfig,\n} from \"../common.speech/Exports\";\nimport {\n    createNoDashGuid,\n    IAudioDestination,\n    IStringDictionary,\n    marshalPromiseToCallbacks,\n    Queue\n} from \"../common/Exports\";\nimport { AudioOutputConfigImpl } from \"./Audio/AudioConfig\";\nimport { AudioFileWriter } from \"./Audio/AudioFileWriter\";\nimport { AudioOutputFormatImpl } from \"./Audio/AudioOutputFormat\";\nimport {\n    PullAudioOutputStreamImpl,\n    PushAudioOutputStreamImpl\n} from \"./Audio/AudioOutputStream\";\nimport { Contracts } from \"./Contracts\";\nimport {\n    AudioConfig,\n    AudioOutputStream,\n    AutoDetectSourceLanguageConfig,\n    PropertyCollection,\n    PropertyId,\n    PullAudioOutputStream,\n    PushAudioOutputStreamCallback,\n    SpeechConfig,\n    SpeechSynthesisBookmarkEventArgs,\n    SpeechSynthesisEventArgs,\n    SpeechSynthesisOutputFormat,\n    SpeechSynthesisResult,\n    SpeechSynthesisVisemeEventArgs,\n    SpeechSynthesisWordBoundaryEventArgs,\n    SynthesisVoicesResult,\n} from \"./Exports\";\nimport { SpeechConfigImpl } from \"./SpeechConfig\";\n\n/**\n * Defines the class SpeechSynthesizer for text to speech.\n * Updated in version 1.16.0\n * @class SpeechSynthesizer\n */\nexport class SpeechSynthesizer {\n    protected audioConfig: AudioConfig;\n    protected privAdapter: SynthesisAdapterBase;\n    protected privRestAdapter: SynthesisRestAdapter;\n    protected privProperties: PropertyCollection;\n    protected synthesisRequestQueue: Queue<SynthesisRequest>;\n\n    /**\n     * Defines event handler for synthesis start events.\n     * @member SpeechSynthesizer.prototype.synthesisStarted\n     * @function\n     * @public\n     */\n    public synthesisStarted: (sender: SpeechSynthesizer, event: SpeechSynthesisEventArgs) => void;\n\n    /**\n     * Defines event handler for synthesizing events.\n     * @member SpeechSynthesizer.prototype.synthesizing\n     * @function\n     * @public\n     */\n    public synthesizing: (sender: SpeechSynthesizer, event: SpeechSynthesisEventArgs) => void;\n\n    /**\n     * Defines event handler for synthesis completed events.\n     * @member SpeechSynthesizer.prototype.synthesisCompleted\n     * @function\n     * @public\n     */\n    public synthesisCompleted: (sender: SpeechSynthesizer, event: SpeechSynthesisEventArgs) => void;\n\n    /**\n     * Defines event handler for synthesis cancelled events.\n     * @member SpeechSynthesizer.prototype.SynthesisCanceled\n     * @function\n     * @public\n     */\n    public SynthesisCanceled: (sender: SpeechSynthesizer, event: SpeechSynthesisEventArgs) => void;\n\n    /**\n     * Defines event handler for word boundary events\n     * @member SpeechSynthesizer.prototype.wordBoundary\n     * @function\n     * @public\n     */\n    public wordBoundary: (sender: SpeechSynthesizer, event: SpeechSynthesisWordBoundaryEventArgs) => void;\n\n    /**\n     * Defines event handler for bookmark reached events\n     * Added in version 1.16.0\n     * @member SpeechSynthesizer.prototype.bookmarkReached\n     * @function\n     * @public\n     */\n    public bookmarkReached: (sender: SpeechSynthesizer, event: SpeechSynthesisBookmarkEventArgs) => void;\n\n    /**\n     * Defines event handler for viseme received event\n     * Added in version 1.16.0\n     * @member SpeechSynthesizer.prototype.visemeReceived\n     * @function\n     * @public\n     */\n    public visemeReceived: (sender: SpeechSynthesizer, event: SpeechSynthesisVisemeEventArgs) => void;\n\n    /**\n     * Gets the authorization token used to communicate with the service.\n     * @member SpeechSynthesizer.prototype.authorizationToken\n     * @function\n     * @public\n     * @returns {string} Authorization token.\n     */\n    public get authorizationToken(): string {\n        return this.properties.getProperty(PropertyId.SpeechServiceAuthorization_Token);\n    }\n\n    /**\n     * Gets/Sets the authorization token used to communicate with the service.\n     * @member SpeechSynthesizer.prototype.authorizationToken\n     * @function\n     * @public\n     * @param {string} token - Authorization token.\n     */\n    public set authorizationToken(token: string) {\n        Contracts.throwIfNullOrWhitespace(token, \"token\");\n        this.properties.setProperty(PropertyId.SpeechServiceAuthorization_Token, token);\n    }\n\n    /**\n     * The collection of properties and their values defined for this SpeechSynthesizer.\n     * @member SpeechSynthesizer.prototype.properties\n     * @function\n     * @public\n     * @returns {PropertyCollection} The collection of properties and their values defined for this SpeechSynthesizer.\n     */\n    public get properties(): PropertyCollection {\n        return this.privProperties;\n    }\n\n    /**\n     * Indicates if auto detect source language is enabled\n     * @member SpeechSynthesizer.prototype.properties\n     * @function\n     * @public\n     * @returns {boolean} if auto detect source language is enabled\n     */\n    public get autoDetectSourceLanguage(): boolean {\n        return this.properties.getProperty(PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages) === AutoDetectSourceLanguagesOpenRangeOptionName;\n    }\n\n    private privDisposed: boolean;\n    private privConnectionFactory: ISynthesisConnectionFactory;\n    private privSynthesizing: boolean;\n\n    /**\n     * SpeechSynthesizer constructor.\n     * @constructor\n     * @param {SpeechConfig} speechConfig - An set of initial properties for this synthesizer.\n     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the synthesizer.\n     */\n    public constructor(speechConfig: SpeechConfig, audioConfig?: AudioConfig) {\n        const speechConfigImpl: SpeechConfigImpl = speechConfig as SpeechConfigImpl;\n        Contracts.throwIfNull(speechConfigImpl, \"speechConfig\");\n\n        if (audioConfig !== null) {\n            if (audioConfig === undefined) {\n                this.audioConfig = (typeof window === \"undefined\") ? undefined : AudioConfig.fromDefaultSpeakerOutput();\n            } else {\n                this.audioConfig = audioConfig;\n            }\n        }\n\n        this.privProperties = speechConfigImpl.properties.clone();\n        this.privDisposed = false;\n        this.privSynthesizing = false;\n        this.privConnectionFactory = new SpeechSynthesisConnectionFactory();\n        this.synthesisRequestQueue = new Queue<SynthesisRequest>();\n        this.implCommonSynthesizeSetup();\n    }\n\n    /**\n     * SpeechSynthesizer constructor.\n     * @constructor\n     * @param {SpeechConfig} speechConfig - an set of initial properties for this synthesizer\n     * @param {AutoDetectSourceLanguageConfig} autoDetectSourceLanguageConfig - An source language detection configuration associated with the synthesizer\n     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the synthesizer\n     */\n    public static FromConfig(speechConfig: SpeechConfig, autoDetectSourceLanguageConfig: AutoDetectSourceLanguageConfig, audioConfig?: AudioConfig): SpeechSynthesizer {\n        const speechConfigImpl: SpeechConfigImpl = speechConfig as SpeechConfigImpl;\n        autoDetectSourceLanguageConfig.properties.mergeTo(speechConfigImpl.properties);\n        return new SpeechSynthesizer(speechConfig, audioConfig);\n    }\n\n    public buildSsml(text: string): string {\n        const languageToDefaultVoice: IStringDictionary<string>  = {\n            [\"af-ZA\"]: \"af-ZA-AdriNeural\",\n            [\"am-ET\"]: \"am-ET-AmehaNeural\",\n            [\"ar-AE\"]: \"ar-AE-FatimaNeural\",\n            [\"ar-BH\"]: \"ar-BH-AliNeural\",\n            [\"ar-DZ\"]: \"ar-DZ-AminaNeural\",\n            [\"ar-EG\"]: \"ar-EG-SalmaNeural\",\n            [\"ar-IQ\"]: \"ar-IQ-BasselNeural\",\n            [\"ar-JO\"]: \"ar-JO-SanaNeural\",\n            [\"ar-KW\"]: \"ar-KW-FahedNeural\",\n            [\"ar-LY\"]: \"ar-LY-ImanNeural\",\n            [\"ar-MA\"]: \"ar-MA-JamalNeural\",\n            [\"ar-QA\"]: \"ar-QA-AmalNeural\",\n            [\"ar-SA\"]: \"ar-SA-HamedNeural\",\n            [\"ar-SY\"]: \"ar-SY-AmanyNeural\",\n            [\"ar-TN\"]: \"ar-TN-HediNeural\",\n            [\"ar-YE\"]: \"ar-YE-MaryamNeural\",\n            [\"bg-BG\"]: \"bg-BG-BorislavNeural\",\n            [\"bn-BD\"]: \"bn-BD-NabanitaNeural\",\n            [\"bn-IN\"]: \"bn-IN-BashkarNeural\",\n            [\"ca-ES\"]: \"ca-ES-JoanaNeural\",\n            [\"cs-CZ\"]: \"cs-CZ-AntoninNeural\",\n            [\"cy-GB\"]: \"cy-GB-AledNeural\",\n            [\"da-DK\"]: \"da-DK-ChristelNeural\",\n            [\"de-AT\"]: \"de-AT-IngridNeural\",\n            [\"de-CH\"]: \"de-CH-JanNeural\",\n            [\"de-DE\"]: \"de-DE-KatjaNeural\",\n            [\"el-GR\"]: \"el-GR-AthinaNeural\",\n            [\"en-AU\"]: \"en-AU-NatashaNeural\",\n            [\"en-CA\"]: \"en-CA-ClaraNeural\",\n            [\"en-GB\"]: \"en-GB-LibbyNeural\",\n            [\"en-HK\"]: \"en-HK-SamNeural\",\n            [\"en-IE\"]: \"en-IE-ConnorNeural\",\n            [\"en-IN\"]: \"en-IN-NeerjaNeural\",\n            [\"en-KE\"]: \"en-KE-AsiliaNeural\",\n            [\"en-NG\"]: \"en-NG-AbeoNeural\",\n            [\"en-NZ\"]: \"en-NZ-MitchellNeural\",\n            [\"en-PH\"]: \"en-PH-JamesNeural\",\n            [\"en-SG\"]: \"en-SG-LunaNeural\",\n            [\"en-TZ\"]: \"en-TZ-ElimuNeural\",\n            [\"en-US\"]: \"en-US-JennyNeural\",\n            [\"en-ZA\"]: \"en-ZA-LeahNeural\",\n            [\"es-AR\"]: \"es-AR-ElenaNeural\",\n            [\"es-BO\"]: \"es-BO-MarceloNeural\",\n            [\"es-CL\"]: \"es-CL-CatalinaNeural\",\n            [\"es-CO\"]: \"es-CO-GonzaloNeural\",\n            [\"es-CR\"]: \"es-CR-JuanNeural\",\n            [\"es-CU\"]: \"es-CU-BelkysNeural\",\n            [\"es-DO\"]: \"es-DO-EmilioNeural\",\n            [\"es-EC\"]: \"es-EC-AndreaNeural\",\n            [\"es-ES\"]: \"es-ES-AlvaroNeural\",\n            [\"es-GQ\"]: \"es-GQ-JavierNeural\",\n            [\"es-GT\"]: \"es-GT-AndresNeural\",\n            [\"es-HN\"]: \"es-HN-CarlosNeural\",\n            [\"es-MX\"]: \"es-MX-DaliaNeural\",\n            [\"es-NI\"]: \"es-NI-FedericoNeural\",\n            [\"es-PA\"]: \"es-PA-MargaritaNeural\",\n            [\"es-PE\"]: \"es-PE-AlexNeural\",\n            [\"es-PR\"]: \"es-PR-KarinaNeural\",\n            [\"es-PY\"]: \"es-PY-MarioNeural\",\n            [\"es-SV\"]: \"es-SV-LorenaNeural\",\n            [\"es-US\"]: \"es-US-AlonsoNeural\",\n            [\"es-UY\"]: \"es-UY-MateoNeural\",\n            [\"es-VE\"]: \"es-VE-PaolaNeural\",\n            [\"et-EE\"]: \"et-EE-AnuNeural\",\n            [\"fa-IR\"]: \"fa-IR-DilaraNeural\",\n            [\"fi-FI\"]: \"fi-FI-SelmaNeural\",\n            [\"fil-PH\"]: \"fil-PH-AngeloNeural\",\n            [\"fr-BE\"]: \"fr-BE-CharlineNeural\",\n            [\"fr-CA\"]: \"fr-CA-SylvieNeural\",\n            [\"fr-CH\"]: \"fr-CH-ArianeNeural\",\n            [\"fr-FR\"]: \"fr-FR-DeniseNeural\",\n            [\"ga-IE\"]: \"ga-IE-ColmNeural\",\n            [\"gl-ES\"]: \"gl-ES-RoiNeural\",\n            [\"gu-IN\"]: \"gu-IN-DhwaniNeural\",\n            [\"he-IL\"]: \"he-IL-AvriNeural\",\n            [\"hi-IN\"]: \"hi-IN-MadhurNeural\",\n            [\"hr-HR\"]: \"hr-HR-GabrijelaNeural\",\n            [\"hu-HU\"]: \"hu-HU-NoemiNeural\",\n            [\"id-ID\"]: \"id-ID-ArdiNeural\",\n            [\"is-IS\"]: \"is-IS-GudrunNeural\",\n            [\"it-IT\"]: \"it-IT-IsabellaNeural\",\n            [\"ja-JP\"]: \"ja-JP-NanamiNeural\",\n            [\"jv-ID\"]: \"jv-ID-DimasNeural\",\n            [\"kk-KZ\"]: \"kk-KZ-AigulNeural\",\n            [\"km-KH\"]: \"km-KH-PisethNeural\",\n            [\"kn-IN\"]: \"kn-IN-GaganNeural\",\n            [\"ko-KR\"]: \"ko-KR-SunHiNeural\",\n            [\"lo-LA\"]: \"lo-LA-ChanthavongNeural\",\n            [\"lt-LT\"]: \"lt-LT-LeonasNeural\",\n            [\"lv-LV\"]: \"lv-LV-EveritaNeural\",\n            [\"mk-MK\"]: \"mk-MK-AleksandarNeural\",\n            [\"ml-IN\"]: \"ml-IN-MidhunNeural\",\n            [\"mr-IN\"]: \"mr-IN-AarohiNeural\",\n            [\"ms-MY\"]: \"ms-MY-OsmanNeural\",\n            [\"mt-MT\"]: \"mt-MT-GraceNeural\",\n            [\"my-MM\"]: \"my-MM-NilarNeural\",\n            [\"nb-NO\"]: \"nb-NO-PernilleNeural\",\n            [\"nl-BE\"]: \"nl-BE-ArnaudNeural\",\n            [\"nl-NL\"]: \"nl-NL-ColetteNeural\",\n            [\"pl-PL\"]: \"pl-PL-AgnieszkaNeural\",\n            [\"ps-AF\"]: \"ps-AF-GulNawazNeural\",\n            [\"pt-BR\"]: \"pt-BR-FranciscaNeural\",\n            [\"pt-PT\"]: \"pt-PT-DuarteNeural\",\n            [\"ro-RO\"]: \"ro-RO-AlinaNeural\",\n            [\"ru-RU\"]: \"ru-RU-SvetlanaNeural\",\n            [\"si-LK\"]: \"si-LK-SameeraNeural\",\n            [\"sk-SK\"]: \"sk-SK-LukasNeural\",\n            [\"sl-SI\"]: \"sl-SI-PetraNeural\",\n            [\"so-SO\"]: \"so-SO-MuuseNeural\",\n            [\"sr-RS\"]: \"sr-RS-NicholasNeural\",\n            [\"su-ID\"]: \"su-ID-JajangNeural\",\n            [\"sv-SE\"]: \"sv-SE-SofieNeural\",\n            [\"sw-KE\"]: \"sw-KE-RafikiNeural\",\n            [\"sw-TZ\"]: \"sw-TZ-DaudiNeural\",\n            [\"ta-IN\"]: \"ta-IN-PallaviNeural\",\n            [\"ta-LK\"]: \"ta-LK-KumarNeural\",\n            [\"ta-SG\"]: \"ta-SG-AnbuNeural\",\n            [\"te-IN\"]: \"te-IN-MohanNeural\",\n            [\"th-TH\"]: \"th-TH-PremwadeeNeural\",\n            [\"tr-TR\"]: \"tr-TR-AhmetNeural\",\n            [\"uk-UA\"]: \"uk-UA-OstapNeural\",\n            [\"ur-IN\"]: \"ur-IN-GulNeural\",\n            [\"ur-PK\"]: \"ur-PK-AsadNeural\",\n            [\"uz-UZ\"]: \"uz-UZ-MadinaNeural\",\n            [\"vi-VN\"]: \"vi-VN-HoaiMyNeural\",\n            [\"zh-CN\"]: \"zh-CN-XiaoxiaoNeural\",\n            [\"zh-HK\"]: \"zh-HK-HiuMaanNeural\",\n            [\"zh-TW\"]: \"zh-TW-HsiaoChenNeural\",\n            [\"zu-ZA\"]: \"zu-ZA-ThandoNeural\",\n        };\n\n        let language = this.properties.getProperty(PropertyId.SpeechServiceConnection_SynthLanguage, \"en-US\");\n        let voice = this.properties.getProperty(PropertyId.SpeechServiceConnection_SynthVoice, \"\");\n        let ssml: string = SpeechSynthesizer.XMLEncode(text);\n        if (this.autoDetectSourceLanguage) {\n            language = \"en-US\";\n        } else {\n            voice = voice || languageToDefaultVoice[language];\n        }\n        if (voice) {\n            ssml = `<voice name='${voice}'>${ssml}</voice>`;\n        }\n        ssml = `<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${language}'>${ssml}</speak>`;\n        return ssml;\n    }\n\n    /**\n     * Executes speech synthesis on plain text.\n     * The task returns the synthesis result.\n     * @member SpeechSynthesizer.prototype.speakTextAsync\n     * @function\n     * @public\n     * @param text - Text to be synthesized.\n     * @param cb - Callback that received the SpeechSynthesisResult.\n     * @param err - Callback invoked in case of an error.\n     * @param stream - AudioOutputStream to receive the synthesized audio.\n     */\n    public speakTextAsync(text: string, cb?: (e: SpeechSynthesisResult) => void, err?: (e: string) => void, stream?: AudioOutputStream | PushAudioOutputStreamCallback | PathLike): void {\n        this.speakImpl(text, false, cb, err, stream);\n    }\n\n    /**\n     * Executes speech synthesis on SSML.\n     * The task returns the synthesis result.\n     * @member SpeechSynthesizer.prototype.speakSsmlAsync\n     * @function\n     * @public\n     * @param ssml - SSML to be synthesized.\n     * @param cb - Callback that received the SpeechSynthesisResult.\n     * @param err - Callback invoked in case of an error.\n     * @param stream - AudioOutputStream to receive the synthesized audio.\n     */\n    public speakSsmlAsync(ssml: string, cb?: (e: SpeechSynthesisResult) => void, err?: (e: string) => void, stream?: AudioOutputStream | PushAudioOutputStreamCallback | PathLike): void {\n        this.speakImpl(ssml, true, cb, err, stream);\n    }\n\n    /**\n     * Get list of synthesis voices available.\n     * The task returns the synthesis voice result.\n     * @member SpeechSynthesizer.prototype.getVoicesAsync\n     * @function\n     * @async\n     * @public\n     * @param locale - Locale of voices in BCP-47 format; if left empty, get all available voices.\n     * @return {Promise<SynthesisVoicesResult>} - Promise of a SynthesisVoicesResult.\n     */\n    public async getVoicesAsync(locale: string = \"\"): Promise<SynthesisVoicesResult> {\n        return this.getVoices(locale);\n    }\n\n    /**\n     * Dispose of associated resources.\n     * @member SpeechSynthesizer.prototype.close\n     * @function\n     * @public\n     */\n    public close(cb?: () => void, err?: (error: string) => void): void {\n        Contracts.throwIfDisposed(this.privDisposed);\n\n        marshalPromiseToCallbacks(this.dispose(true), cb, err);\n    }\n\n    /**\n     * @Internal\n     * Do not use externally, object returned will change without warning or notice.\n     */\n    public get internalData(): object {\n        return this.privAdapter;\n    }\n\n    /**\n     * This method performs cleanup of resources.\n     * The Boolean parameter disposing indicates whether the method is called\n     * from Dispose (if disposing is true) or from the finalizer (if disposing is false).\n     * Derived classes should override this method to dispose resource if needed.\n     * @member SpeechSynthesizer.prototype.dispose\n     * @function\n     * @public\n     * @param {boolean} disposing - Flag to request disposal.\n     */\n    protected async dispose(disposing: boolean): Promise<void> {\n        if (this.privDisposed) {\n            return;\n        }\n\n        if (disposing) {\n            if (this.privAdapter) {\n                await this.privAdapter.dispose();\n            }\n        }\n\n        this.privDisposed = true;\n    }\n\n    //\n    // ################################################################################################################\n    // IMPLEMENTATION.\n    // Move to independent class\n    // ################################################################################################################\n    //\n    protected createSynthesizerConfig(speechConfig: SpeechServiceConfig): SynthesizerConfig {\n        return new SynthesizerConfig(\n            speechConfig,\n            this.privProperties);\n    }\n\n    // Creates the synthesis adapter\n    protected createSynthesisAdapter(\n        authentication: IAuthentication,\n        connectionFactory: ISynthesisConnectionFactory,\n        audioConfig: AudioConfig,\n        synthesizerConfig: SynthesizerConfig): SynthesisAdapterBase {\n        return new SynthesisAdapterBase(authentication, connectionFactory,\n            synthesizerConfig, this, this.audioConfig as AudioOutputConfigImpl);\n    }\n\n    protected implCommonSynthesizeSetup(): void {\n\n        let osPlatform = (typeof window !== \"undefined\") ? \"Browser\" : \"Node\";\n        let osName = \"unknown\";\n        let osVersion = \"unknown\";\n\n        if (typeof navigator !== \"undefined\") {\n            osPlatform = osPlatform + \"/\" + navigator.platform;\n            osName = navigator.userAgent;\n            osVersion = navigator.appVersion;\n        }\n\n        const synthesizerConfig = this.createSynthesizerConfig(\n            new SpeechServiceConfig(\n                new Context(new OS(osPlatform, osName, osVersion))));\n\n        const subscriptionKey = this.privProperties.getProperty(PropertyId.SpeechServiceConnection_Key, undefined);\n        const authentication = (subscriptionKey && subscriptionKey !== \"\") ?\n            new CognitiveSubscriptionKeyAuthentication(subscriptionKey) :\n            new CognitiveTokenAuthentication(\n                (): Promise<string> => {\n                    const authorizationToken = this.privProperties.getProperty(PropertyId.SpeechServiceAuthorization_Token, undefined);\n                    return Promise.resolve(authorizationToken);\n                },\n                (): Promise<string> => {\n                    const authorizationToken = this.privProperties.getProperty(PropertyId.SpeechServiceAuthorization_Token, undefined);\n                    return Promise.resolve(authorizationToken);\n                });\n\n        this.privAdapter = this.createSynthesisAdapter(\n            authentication,\n            this.privConnectionFactory,\n            this.audioConfig,\n            synthesizerConfig);\n\n        this.privAdapter.audioOutputFormat = AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(\n            SpeechSynthesisOutputFormat[this.properties.getProperty(PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined) as keyof typeof SpeechSynthesisOutputFormat]\n        );\n\n        this.privRestAdapter = new SynthesisRestAdapter(synthesizerConfig, authentication);\n    }\n\n    protected speakImpl(text: string, IsSsml: boolean, cb?: (e: SpeechSynthesisResult) => void, err?: (e: string) => void, dataStream?: AudioOutputStream | PushAudioOutputStreamCallback | PathLike): void {\n        try {\n            Contracts.throwIfDisposed(this.privDisposed);\n            const requestId = createNoDashGuid();\n            let audioDestination;\n            if (dataStream instanceof PushAudioOutputStreamCallback) {\n                audioDestination = new PushAudioOutputStreamImpl(dataStream);\n            } else if (dataStream instanceof PullAudioOutputStream) {\n                audioDestination = dataStream as PullAudioOutputStreamImpl;\n            } else if (dataStream !== undefined) {\n                audioDestination = new AudioFileWriter(dataStream as PathLike);\n            } else {\n                audioDestination = undefined;\n            }\n            this.synthesisRequestQueue.enqueue(new SynthesisRequest(requestId, text, IsSsml, (e: SpeechSynthesisResult): void => {\n                this.privSynthesizing = false;\n                if (!!cb) {\n                    try {\n                        cb(e);\n                    } catch (e) {\n                        if (!!err) {\n                            err(e as string);\n                        }\n                    }\n                }\n                cb = undefined;\n                /* eslint-disable no-empty */\n                this.adapterSpeak().catch((): void => { });\n\n            }, (e: string): void => {\n                if (!!err) {\n                    err(e);\n                }\n            }, audioDestination));\n\n            /* eslint-disable no-empty-function */\n            this.adapterSpeak().catch((): void => { });\n\n        } catch (error) {\n            if (!!err) {\n                if (error instanceof Error) {\n                    const typedError: Error = error;\n                    err(typedError.name + \": \" + typedError.message);\n                } else {\n                    err(error as string);\n                }\n            }\n\n            // Destroy the synthesizer.\n            /* eslint-disable no-empty */\n            this.dispose(true).catch((): void => { });\n        }\n    }\n\n    protected async getVoices(locale: string): Promise<SynthesisVoicesResult> {\n        const requestId = createNoDashGuid();\n        const response: IRestResponse = await this.privRestAdapter.getVoicesList(requestId);\n        if (response.ok && Array.isArray(response.json)) {\n            let json = response.json;\n            if (!!locale && locale.length > 0) {\n                json = json.filter((item: { Locale: string }): boolean => !!item.Locale && item.Locale.toLowerCase() === locale.toLowerCase() );\n            }\n            return new SynthesisVoicesResult(requestId, json, undefined);\n        } else {\n            return new SynthesisVoicesResult(requestId, undefined, `Error: ${response.status}: ${response.statusText}`);\n        }\n   }\n\n    protected async adapterSpeak(): Promise<void> {\n        if (!this.privDisposed && !this.privSynthesizing) {\n            this.privSynthesizing = true;\n            const request: SynthesisRequest = await this.synthesisRequestQueue.dequeue();\n            return this.privAdapter.Speak(request.text, request.isSSML, request.requestId, request.cb, request.err, request.dataStream);\n        }\n    }\n\n    private static XMLEncode(text: string): string {\n        return text.replace(/&/g, \"&amp;\")\n            .replace(/</g, \"&lt;\")\n            .replace(/>/g, \"&gt;\")\n            .replace(/\"/g, \"&quot;\")\n            .replace(/'/g, \"&apos;\");\n    }\n}\n\nexport class SynthesisRequest {\n    public requestId: string;\n    public text: string;\n    public isSSML: boolean;\n    public cb: (e: SpeechSynthesisResult) => void;\n    public err: (e: string) => void;\n    public dataStream: IAudioDestination;\n\n    public constructor(requestId: string, text: string, isSSML: boolean, cb?: (e: SpeechSynthesisResult) => void, err?: (e: string) => void, dataStream?: IAudioDestination) {\n        this.requestId = requestId;\n        this.text = text;\n        this.isSSML = isSSML;\n        this.cb = cb;\n        this.err = err;\n        this.dataStream = dataStream;\n    }\n}\n"]}